import { ReactNode, useEffect, useMemo, useRef } from 'react'

import * as Lantern from '~/components/common/lantern-effect'
import { Section } from '~/components/layout/section'
import { TitleAndSubtitle } from '~/components/primitives/texts'
import { useIsomorphicLayoutEffect } from '~/hooks/use-isomorphic-layout-effect'
import { useTabletLgBreakpoint } from '~/hooks/use-media'
import { gsap } from '~/lib/gsap'

import s from './debug-with-friends.module.scss'

export const DebugWithFriends = () => {
  const isTablet = useTabletLgBreakpoint()

  const headerContainer = useRef<HTMLDivElement>(null)
  const calloutOne = useRef<HTMLDivElement>(null)
  const calloutTwo = useRef<HTMLDivElement>(null)
  const uglyTitle = useRef<HTMLImageElement>(null)
  const tl = useRef<GSAPTimeline>()

  useIsomorphicLayoutEffect(() => {
    if (isTablet) return
    const container = headerContainer.current
    if (!container) return
    const title: HTMLHeadingElement | null = container.querySelector('h2')
    const uglyTxt = uglyTitle.current
    const c1 = calloutOne.current
    const c2 = calloutTwo.current
    if (!title || !c1 || !c2 || !uglyTxt) return
    const c1Text = c1.querySelector('p')
    const c2Text = c2.querySelector('p')
    const c2Click = c2.querySelectorAll('span')

    const { clientWidth: titleWidth, clientHeight: titleHeight } = title
    const containerWidth = headerContainer.current.clientWidth
    const bound = (containerWidth - titleWidth) / 2

    const ctx = gsap.context(() => {
      gsap.set(uglyTxt, {
        width: titleWidth,
        height: titleHeight,
        opacity: 1
      })
      tl.current = gsap
        .timeline({
          scrollTrigger: {
            trigger: container,
            start: 'top 50%'
          },
          defaults: {
            ease: 'power1.inOut',
            duration: 0.725
          }
        })
        .from(c1Text, {
          opacity: 0,
          scale: 0.9
        })
        .to(c1, {
          right: bound + c1.clientWidth,
          top: titleHeight
        })
        .to(c1, {
          right: bound - c1.clientWidth,
          top: titleHeight
        })
        .to(
          uglyTxt,
          {
            ['--after-width']: '100%'
          },
          '<'
        )
        .from(c2Text, {
          delay: 0.5,
          opacity: 0,
          scale: 0.9
        })
        .to(
          c1,
          {
            top: titleHeight,
            right: -140
          },
          '<'
        )
        .to(c2, {
          left: bound - c2.clientWidth,
          top: titleHeight / 2
        })
        .from(title, {
          opacity: 0,
          duration: 0.225,
          ease: 'power1.out'
        })
        .to(
          uglyTxt,
          {
            opacity: '0',
            delay: 0.15,
            duration: 0.225,
            ease: 'power1.out'
          },
          '<'
        )
        .to(
          c2Click,
          {
            opacity: 0,
            scale: 24,
            stagger: 0.15
          },
          '<-0.35'
        )
        .to(c2, {
          left: -20,
          bottom: 24
        })
    }, container)
    return () => {
      ctx?.revert()
      ctx?.kill()
    }
  }, [isTablet])

  return (
    <Section
      id="homepage-debug-with-friends"
      className={s.section}
      data-sitemap
      data-sitemap-icon="colaboration"
      data-sitemap-short-title="Colaboration"
      data-sitemap-complete-title="Debug with Friends."
    >
      <div className={s.container}>
        <div className={s.containerWrapper} ref={headerContainer}>
          <TitleAndSubtitle
            className={s.titleAndSubtitle}
            title={{
              as: 'h2',
              children: 'Debug with friends'
            }}
            subtitle={{
              children:
                'Modern collaboration features to make it easier to share context, integrate with tools, and squash bugs as a team.'
            }}
          />

          <div ref={uglyTitle} className={s.uglyTitle}>
            <svg
              viewBox="0 0 379 43"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M59.6894 32.7055C57.3333 32.7053 57.3333 32.7053 57.3332 30.5607C57.3332 28.3048 57.3345 26.049 57.3357 23.7932L57.3357 23.7724C57.3398 16.3693 57.3438 8.96615 57.3044 1.56326C57.298 0.363944 57.5187 -0.0269126 58.8137 0.00142171L59.0088 0.00565209C62.6652 0.0845424 62.6666 0.0845727 62.6666 3.85526C62.6666 4.30458 62.6726 4.75426 62.6786 5.20395C62.6927 6.25534 62.7067 7.30674 62.6439 8.35352C62.5801 9.41721 62.868 9.75467 63.987 9.73443C65.9612 9.69873 67.9361 9.70309 69.9109 9.70745C71.9915 9.71204 74.072 9.71664 76.1515 9.67439C77.3691 9.64965 77.9138 9.91638 77.6705 11.193C77.4961 12.108 77.8556 12.5417 78.8189 12.3729C79.7409 12.2113 80.0321 12.5609 80.0229 13.524C79.974 18.6342 79.9782 23.7453 80.02 28.8556C80.0275 29.7684 79.8174 30.2252 78.851 30.036C77.7037 29.8113 77.5282 30.4501 77.6701 31.3534C77.8359 32.4096 77.4747 32.8747 76.3483 32.7217C75.9852 32.6724 75.6144 32.6851 75.243 32.6979C74.945 32.7081 74.6466 32.7183 74.3514 32.6965C73.2523 32.6154 72.3447 32.6721 72.6601 34.1888C72.7897 34.8119 72.5268 35.0889 71.851 35.0508C70.965 35.0009 70.0707 34.9897 69.1861 35.0508C67.9595 35.1355 66.9582 35.0968 67.319 33.3886C67.4698 32.6749 66.979 32.6901 66.5344 32.7038C66.4723 32.7058 66.4112 32.7077 66.3528 32.7075C64.7678 32.7043 63.1828 32.7047 61.5336 32.7052C60.9285 32.7054 60.3149 32.7056 59.6894 32.7055ZM334.667 16.738C334.566 15.3919 334.552 14.2963 336.298 14.6971C336.754 14.8018 337.045 14.6106 337.003 14.0764C336.987 13.88 336.992 13.6821 336.996 13.4842C336.998 13.4039 337 13.3236 337 13.2434C337.019 9.70568 337.02 9.70568 340.632 9.70568C341.56 9.70568 342.489 9.70143 343.417 9.69717C345.767 9.68641 348.116 9.67565 350.464 9.73382C351.644 9.76306 352.11 9.55862 352.036 8.23496C351.961 6.88992 351.974 5.54035 351.986 4.19036V4.19018V4.19V4.18982V4.18964V4.18946V4.18928V4.1891V4.18892V4.18874V4.18856V4.18838V4.1882V4.18802V4.18784V4.18766V4.18748V4.1873C351.996 3.20392 352.005 2.22032 351.98 1.23809C351.958 0.33875 352.146 -0.0265798 353.14 0.0151276C355.08 0.0966226 357.028 0.0710039 358.971 0.0231553C359.735 0.00435028 360.021 0.17479 360.019 1.01465C359.99 11.2359 359.984 21.4574 360.025 31.6786C360.029 32.6634 359.623 32.7268 358.856 32.7174C357.742 32.7039 356.628 32.7069 355.514 32.71H355.513C354.072 32.7139 352.631 32.7178 351.191 32.6858C350.287 32.6657 349.826 32.8673 349.999 33.8485C350.158 34.7566 349.839 35.1045 348.857 35.0624C346.971 34.9818 345.079 34.9943 343.192 35.0584C342.289 35.0891 341.809 34.8777 342.003 33.8984C342.228 32.7597 341.613 32.6016 340.691 32.6954C340.426 32.7225 340.156 32.7127 339.886 32.703C339.598 32.6926 339.31 32.6822 339.027 32.7166C337.629 32.8867 336.618 32.7011 336.994 30.8965C337.161 30.0962 336.666 29.9268 336.027 30.0462C334.754 30.2842 334.626 29.6357 334.643 28.5657C334.686 25.7511 334.679 22.9358 334.672 20.0588C334.669 18.9619 334.667 17.8561 334.667 16.738ZM0 0.194741C4.40862 0.0839768 8.81734 0.0643485 13.2259 0.0447209C15.035 0.0366664 16.8441 0.0286121 18.6531 0.0142601C19.7095 0.0058784 20.2047 0.240245 20.0026 1.35691C19.8621 2.13325 20.1562 2.46529 20.9843 2.38601C21.3571 2.35032 21.734 2.36016 22.1111 2.37C22.4574 2.37903 22.8038 2.38807 23.1473 2.36186C24.3695 2.26862 25.3766 2.3093 25.014 4.01966C24.8429 4.82677 25.5129 4.7821 25.9732 4.68955C27.5781 4.36688 27.8453 5.19203 27.6781 6.51509C27.6443 6.78283 27.6562 7.05657 27.6681 7.33018C27.6804 7.61499 27.6928 7.89966 27.6536 8.17727C27.4854 9.36783 27.8357 9.96752 29.139 9.70902C29.9431 9.54953 30.0209 10.0272 30.0106 10.6755C29.9987 11.4249 30.0043 12.1749 30.01 12.9248V12.925V12.9251V12.9253V12.9254V12.9255V12.9257V12.9258V12.926V12.9261V12.9263V12.9264V12.9265V12.9267V12.9268V12.927V12.9271V12.9273V12.9274V12.9275C30.0185 14.065 30.0271 15.2022 29.9745 16.3367C29.9294 17.3088 30.3469 17.4303 31.1318 17.3839C31.2254 17.3784 31.3197 17.377 31.4122 17.3756C31.9811 17.3669 32.4827 17.3592 32.3515 16.4067C32.295 15.9964 32.3088 15.5774 32.3227 15.1575V15.1575V15.1574V15.1574V15.1573V15.1573V15.1572V15.1572V15.1571V15.1571V15.157V15.157V15.1569V15.1568V15.1568V15.1567V15.1567V15.1566V15.1566V15.1565V15.1565C32.3327 14.8519 32.3428 14.5469 32.3259 14.2445L32.3257 14.2413C32.2603 13.0666 32.2006 11.9929 33.9613 12.3532C34.817 12.5284 34.7312 11.8825 34.6679 11.4064C34.6609 11.3534 34.6541 11.3025 34.6489 11.2551C34.5079 9.95682 35.1099 9.66604 36.2994 9.68285C40.4067 9.74088 44.5157 9.73399 48.6233 9.68458C49.6277 9.67249 50.2332 9.82465 50.0004 10.9952C49.7564 12.2223 50.3543 12.5791 51.4546 12.3683C52.5607 12.1564 52.7847 12.7041 52.6791 13.6615C52.6413 14.0035 52.6508 14.3503 52.6603 14.6974C52.6676 14.9626 52.6748 15.2281 52.661 15.4918L52.6584 15.5416C52.5983 16.6844 52.5407 17.7812 54.2859 17.3801C54.902 17.2385 55.0569 17.6231 55.0004 18.1549C54.9945 18.2098 54.9972 18.266 55.0003 18.3214L55.0003 18.3215V18.3216C55.1242 20.5181 55.186 21.614 54.668 22.1608C54.1523 22.7052 53.0619 22.7052 50.8857 22.7052C49.7907 22.7052 48.6957 22.7093 47.6006 22.7135C44.7537 22.7242 41.9069 22.7349 39.0616 22.6731C37.8547 22.6468 37.4823 23.0141 37.6558 24.148C37.7109 24.5077 37.6925 24.8806 37.6743 25.2503C37.6705 25.3265 37.6668 25.4027 37.6637 25.4786C37.6613 25.5368 37.6587 25.5951 37.656 25.6533L37.656 25.654L37.6559 25.6548L37.6559 25.6555L37.6559 25.6562C37.6069 26.727 37.5601 27.7518 39.2737 27.3881C40.1682 27.1982 40.0645 27.9018 39.993 28.3875C39.9888 28.4157 39.9847 28.4433 39.981 28.4698C39.8303 29.5392 40.2649 29.851 41.2666 29.7181C41.8122 29.6457 42.3832 29.6449 42.9288 29.7173C44.189 29.8845 44.9371 29.6332 44.6848 28.1081C44.5275 27.1573 45.2077 27.2774 45.7038 27.365C45.7824 27.3789 45.8565 27.392 45.9218 27.3998C47.1119 27.543 47.5527 27.1017 47.3328 25.9483C47.1341 24.9062 47.5699 24.6308 48.5913 24.6803C50.419 24.7687 52.2571 24.7691 54.0852 24.6838C55.186 24.6324 55.0924 25.258 55.009 25.8155C54.9931 25.9221 54.9775 26.0263 54.9707 26.1228C54.9607 26.2662 54.9864 26.4415 55.013 26.6226C55.0998 27.2137 55.1958 27.8676 54.0864 27.6846C52.6397 27.446 52.6362 28.221 52.6488 29.2865C52.689 32.6973 52.6583 32.7255 49.2535 32.6886C48.2001 32.6771 47.3461 32.6683 47.6605 34.1175C47.8583 35.0291 47.2783 35.0598 46.5904 35.0488L46.1486 35.0417C44.4083 35.0132 42.6658 34.9846 40.9291 35.0629C39.919 35.1084 39.4703 34.8568 39.663 33.801C39.8165 32.9599 39.5009 32.5821 38.5966 32.6914C38.2843 32.7292 37.9665 32.7181 37.6484 32.707C37.3534 32.6967 37.0583 32.6865 36.7672 32.7151C35.3366 32.856 34.2257 32.7217 34.6581 30.8046C34.8221 30.0775 34.3335 29.934 33.7715 30.0468C32.3945 30.3233 32.1863 29.5926 32.3245 28.4766C32.3526 28.2492 32.3439 28.0175 32.3352 27.7855C32.3272 27.5714 32.3192 27.3572 32.3401 27.146C32.4804 25.7335 32.3775 24.5997 30.4393 25.0267C29.5898 25.2139 29.6304 24.6064 29.6656 24.0805L29.6656 24.0804L29.6692 24.0263L29.6719 23.9833C29.7186 23.2121 29.7501 22.6551 28.6146 22.6602C27.5941 22.6647 27.6267 23.1718 27.6611 23.7052C27.6693 23.8332 27.6776 23.9628 27.6715 24.0872C27.6471 24.5856 27.6314 25.0892 27.6734 25.5853C27.7905 26.9697 27.7578 28.1401 25.784 27.7227C24.8756 27.5306 24.9411 28.1568 24.9952 28.6738C25.0041 28.7582 25.0126 28.8397 25.0165 28.9142C25.0585 29.7105 24.9133 30.2269 23.9605 30.0381C22.8004 29.8083 22.4904 30.399 22.6716 31.4076C22.88 32.5681 22.313 32.7321 21.2971 32.7262C16.0118 32.696 10.7264 32.6994 5.37351 32.7029C3.64222 32.7041 1.90388 32.7052 0.156219 32.7052C0 21.9204 0 11.1357 0 0.194741ZM379 32.5494C378.334 32.7056 377.666 32.7391 377.003 32.6983L376.906 32.6923C375.73 32.6187 374.608 32.5484 374.991 34.3665C375.128 35.0199 374.661 35.0456 374.176 35.0432C373.779 35.0412 373.383 35.0385 372.986 35.0359C371.274 35.0244 369.562 35.0129 367.851 35.0569C367.036 35.0779 366.906 34.6938 367.004 34.0595C367.166 33.0113 366.82 32.6174 365.688 32.6709C365.389 32.685 365.061 32.7282 364.728 32.7721C363.735 32.9029 362.694 33.0401 362.214 32.4359C361.796 31.9096 361.87 30.9927 361.944 30.076C361.977 29.6732 362.009 29.2705 362 28.9009C361.998 28.8252 361.999 28.7494 361.999 28.6736L362 28.6198L362 28.568C362 24.3327 362.283 24.1296 366.635 24.6773C367.471 24.7825 367.401 25.241 367.337 25.6706C367.328 25.7257 367.32 25.7804 367.314 25.8339C367.177 27.0018 367.466 27.6542 368.794 27.3737C369.896 27.141 370.147 27.7125 370.002 28.662C369.89 29.3917 370.082 29.7275 370.95 29.7421C371.884 29.7578 372.14 29.3991 371.994 28.5941C371.797 27.5087 372.299 27.2181 373.275 27.3689C374.246 27.5189 374.71 27.3039 374.721 26.1024C374.731 24.9741 374.183 25.0012 373.575 25.0311C373.462 25.0367 373.347 25.0424 373.233 25.0407C373.072 25.0384 372.91 25.0328 372.748 25.0271C372.297 25.0113 371.845 24.9955 371.404 25.0522C370.143 25.2138 369.359 24.9611 369.659 23.4442C369.808 22.6933 369.301 22.6969 368.78 22.7006L368.742 22.7009C368.022 22.7054 367.302 22.7028 366.582 22.7003H366.582C365.36 22.696 364.138 22.6916 362.916 22.7218C362.182 22.7399 361.974 22.5134 361.984 21.786C362.023 18.9567 362.039 16.1258 361.977 13.2974C361.957 12.3783 362.387 12.266 363.073 12.3782C364.351 12.5868 364.919 12.1199 364.667 10.8007C364.466 9.7469 365.064 9.68008 365.904 9.68979C369.232 9.7283 372.563 9.75588 375.89 9.67767C377.016 9.65122 377.576 9.88202 377.332 11.0934C377.097 12.2648 377.71 12.5196 378.851 12.3723C379 14.1573 379 15.9422 379 17.8831C378.052 18.3439 377.104 18.2288 376.157 18.1139C375.858 18.0777 375.559 18.0414 375.261 18.0233C374.857 17.9988 374.461 17.7294 374.418 17.3273C374.276 15.9986 373.45 15.4903 372.259 15.2313C371.911 15.1556 371.724 14.8727 371.526 14.5728C371.311 14.2481 371.083 13.9034 370.623 13.7802C370.382 14.8355 369.776 15.5189 368.637 15.6088C368.367 15.6301 368.088 15.8268 368.096 16.1468C368.107 16.5446 368.438 16.6852 368.771 16.753C369.221 16.8444 369.678 16.8544 370.134 16.8644C370.341 16.869 370.547 16.8735 370.753 16.8856C371.77 16.9452 372.594 17.1859 372.816 18.3707C372.965 19.1612 373.592 19.2007 374.214 19.2398C374.271 19.2434 374.327 19.2469 374.383 19.251C374.857 19.2857 375.334 19.2696 375.814 19.2533C376.829 19.2189 377.859 19.1841 378.904 19.6273C379 23.9348 379 28.164 379 32.5494ZM120.921 9.71596L120.921 9.71595C120.627 9.71084 120.321 9.70553 119.999 9.70553C119.336 9.70553 118.688 9.71127 118.05 9.71693L118.05 9.71693H118.05H118.05H118.05H118.05H118.049H118.049C116.549 9.73023 115.107 9.74301 113.668 9.67941C112.575 9.63114 112.137 9.9552 112.334 11.0404C112.531 12.1287 112.084 12.5471 110.998 12.3786C110.127 12.2436 109.435 12.3623 109.663 13.5397C109.845 14.4748 109.444 14.8699 108.503 14.7054C107.562 14.5411 107.297 14.925 107.311 15.8694C107.367 19.4236 107.365 22.9797 107.312 26.534C107.298 27.466 107.54 27.8463 108.496 27.7149C109.202 27.6179 109.882 27.6523 109.667 28.6977C109.399 29.9957 110.116 30.144 111.159 30.0618C111.227 30.0565 111.306 30.045 111.389 30.0328C111.85 29.9651 112.461 29.8755 112.309 30.6919C111.912 32.8211 113.159 32.8506 114.659 32.7156C115.045 32.6809 115.434 32.6894 115.824 32.6979H115.824C116.102 32.704 116.381 32.7101 116.658 32.7005C117.143 32.6836 117.432 32.8605 117.326 33.3616C116.936 35.1972 118.08 35.1364 119.325 35.0498C120.154 34.9921 120.992 35.0057 121.823 35.0493C122.459 35.0827 122.796 34.8776 122.661 34.2172C122.363 32.7593 123.174 32.5799 124.323 32.696C124.663 32.7303 125.007 32.722 125.352 32.7136H125.352H125.352H125.352H125.352H125.352H125.352H125.352H125.352H125.352H125.352H125.352H125.353H125.353H125.353H125.353H125.353H125.353H125.353C125.565 32.7084 125.777 32.7033 125.989 32.7081C126.097 32.7106 126.207 32.7056 126.315 32.7007C126.875 32.6752 127.385 32.6519 127.382 33.6926C127.378 34.8883 126.71 34.7976 126.017 34.6882C124.72 34.4832 124.501 35.1451 124.669 36.1912C124.818 37.1165 124.476 37.422 123.512 37.3953C121.727 37.346 119.941 37.3554 118.154 37.3647C117.441 37.3685 116.727 37.3722 116.014 37.3722H116.013C114.141 37.3722 113.206 37.3722 112.744 37.8395C112.283 38.3054 112.291 39.2358 112.308 41.0939L112.309 41.195C112.317 42.1204 112.538 42.4036 113.493 42.3947C118.603 42.3469 123.714 42.3495 128.824 42.393C129.749 42.4009 130.169 42.1737 130.001 41.2152C129.839 40.2901 130.204 39.8499 131.155 40.0436C132.613 40.3405 132.692 39.5292 132.687 38.3822C132.659 31.9635 132.662 25.5447 132.665 19.1259V19.1163C132.666 17.0949 132.667 15.0735 132.667 13.0521C132.667 9.77542 132.665 9.77535 129.537 9.6788L129.331 9.67242C127.873 9.62673 126.967 9.79028 127.327 11.544C127.499 12.3818 126.931 12.4717 126.334 12.3583C126.2 12.3329 126.027 12.3542 125.85 12.3759C125.386 12.4331 124.899 12.4933 125.033 11.7099C125.401 9.55937 124.145 9.58296 122.664 9.69432C122.103 9.73653 121.538 9.72669 120.921 9.71596ZM174.993 19.5513L174.993 19.5458C174.996 18.9499 175 18.3439 175 17.7239C175.003 17.4963 174.994 17.2632 174.985 17.0334V17.0328V17.0323V17.0318V17.0313V17.0309V17.0304V17.03V17.0296V17.0292V17.0288V17.0284V17.0281V17.0278V17.0275V17.0272V17.0269C174.935 15.739 174.89 14.557 176.98 15.0306C177.45 15.137 177.604 14.888 177.683 14.3949C178.375 10.1127 177.997 9.69516 173.671 9.67783C172.594 9.67352 172.133 9.94006 172.332 11.0353C172.528 12.1127 172.096 12.5711 171.003 12.3727C169.923 12.1766 169.602 12.6078 169.639 13.7036C169.694 15.3078 169.685 16.914 169.677 18.5204C169.672 19.4139 169.667 20.3075 169.673 21.2008L169.673 21.2707C169.679 21.9456 169.683 22.4237 168.674 22.4183C167.661 22.4128 167.579 21.9547 167.67 21.2183C167.814 20.0576 167.334 19.5281 166.165 19.7103C165.215 19.8584 164.933 19.484 164.978 18.5412C165.055 16.9342 165.044 15.3192 164.986 13.7106C164.971 13.301 165.024 12.8494 165.077 12.3991C165.194 11.4098 165.309 10.4265 164.703 9.90752C164.174 9.45532 163.173 9.54634 162.183 9.6364C161.776 9.67337 161.371 9.71017 161.002 9.70916C157.376 9.69928 157.33 9.70609 157.362 13.3721C157.371 14.4584 157.085 14.9034 155.999 14.7056C154.909 14.5072 154.582 14.9535 154.641 16.0422C154.7 17.1106 154.689 18.1826 154.678 19.2549V19.255V19.2551V19.2553V19.2554V19.2555V19.2557V19.2558V19.256V19.2561V19.2562V19.2564V19.2565V19.2566V19.2568V19.2569V19.2571V19.2588C154.671 19.9081 154.665 20.5574 154.674 21.2061L154.674 21.2235C154.684 21.936 154.69 22.4187 153.667 22.4182C152.638 22.4177 152.634 21.9328 152.66 21.2077C152.671 20.8747 152.663 20.5401 152.655 20.2058C152.642 19.7048 152.63 19.2043 152.684 18.7105C152.804 17.6232 152.426 17.1733 151.335 17.3721C150.251 17.5695 149.916 17.1327 149.974 16.0386C150.026 15.0633 150.017 14.0849 150.007 13.1063C149.999 12.3067 149.992 11.507 150.017 10.7086C150.043 9.90627 149.801 9.66275 148.998 9.68777C147.166 9.74477 145.327 9.79217 143.501 9.6748C142.318 9.59872 142.243 10.1626 142.329 11.0406C142.345 11.2076 142.337 11.3909 142.328 11.5736C142.297 12.2507 142.266 12.9183 143.499 12.7052C144.442 12.5422 144.732 12.9272 144.687 13.872C144.651 14.6411 144.66 15.4127 144.67 16.1842C144.681 17.0246 144.691 17.8648 144.642 18.7016C144.577 19.7891 144.907 20.2379 145.998 20.0392C147.083 19.8417 147.395 20.2814 147.36 21.3726C147.313 22.7977 147.319 24.2244 147.326 25.6513V25.6526C147.331 26.7806 147.336 27.9087 147.315 29.0362C147.3 29.8313 147.525 30.1929 148.329 30.0354C149.636 29.7789 149.826 30.505 149.663 31.5335C149.515 32.472 149.879 32.7651 150.829 32.7276C152.715 32.6533 154.607 32.6551 156.493 32.7271C157.432 32.7629 157.712 32.49 157.689 31.5405C157.654 30.1437 157.658 28.7459 157.663 27.3482C157.667 26.1353 157.67 24.9224 157.649 23.71C157.634 22.9173 157.855 22.5512 158.661 22.7093C159.965 22.9653 160.159 22.2444 159.997 21.2128C159.851 20.2826 160.204 19.9979 161.158 20.0028C162.088 20.0077 162.38 20.2414 162.356 21.1968C162.32 22.6106 162.324 24.0253 162.329 25.4401C162.333 26.636 162.336 27.8319 162.316 29.0273C162.302 29.8087 162.503 30.1959 163.32 30.0356C164.612 29.782 164.832 30.4808 164.664 31.5248C164.516 32.4498 164.855 32.7664 165.821 32.7284C167.762 32.652 169.709 32.6708 171.651 32.7227C172.435 32.7436 172.712 32.5382 172.685 31.716C172.656 30.8265 172.662 29.9358 172.668 29.0452C172.675 28.1025 172.681 27.1598 172.646 26.2187C172.611 25.2963 172.86 24.8537 173.819 25.0423C174.977 25.27 175.039 24.6176 175.015 23.7191C174.979 22.3513 174.986 20.9824 174.993 19.5563V19.5561V19.5558V19.5555V19.5552V19.5549V19.5546V19.5543V19.554V19.5537V19.5533V19.553V19.5527V19.5523V19.552V19.5517V19.5513ZM291.387 24.6953C289.501 24.9246 289.807 23.8529 290.431 22.7137C291.603 22.7121 292.766 22.7092 293.924 22.7063L293.925 22.7063C298.03 22.6962 302.06 22.6863 306.089 22.7332C307.136 22.7454 307.406 22.4655 307.358 21.4449C307.271 19.5601 307.285 17.6666 307.355 15.7803C307.388 14.8873 307.103 14.5475 306.242 14.708C305.195 14.9031 304.808 14.4618 305.001 13.4492C305.212 12.3503 304.547 12.2461 303.746 12.3799C302.564 12.5774 302.113 12.1081 302.334 10.9501C302.533 9.90845 302.096 9.65899 301.076 9.67969C298.628 9.72938 296.178 9.72082 293.728 9.71225C292.789 9.70896 291.849 9.70567 290.91 9.70567H290.91C287.072 9.70567 287.047 9.70567 287.019 13.4797C287.013 14.3305 286.93 14.9068 285.894 14.704C284.816 14.493 284.627 14.9946 284.644 15.9793C284.703 19.4781 284.69 22.9789 284.651 26.4784C284.641 27.3292 284.735 27.907 285.773 27.704C286.849 27.4935 287.058 27.9909 287.029 28.9788C287.02 29.3016 286.975 29.6567 286.93 30.0157C286.807 30.9903 286.68 31.9947 287.251 32.4682C287.851 32.9659 289.02 32.8479 290.081 32.7407C290.32 32.7166 290.554 32.693 290.774 32.6771C291.857 32.599 292.142 32.9959 292.012 33.9826L292.009 34.0059C291.939 34.5357 291.867 35.0803 292.776 35.0566C294.941 35.0001 297.109 35.0216 299.275 35.0493C299.878 35.0569 300.102 34.8071 299.994 34.2656C299.677 32.6891 300.574 32.5664 301.776 32.6932C302.088 32.7262 302.406 32.7139 302.724 32.7016C303.076 32.688 303.428 32.6743 303.772 32.7225C304.854 32.8742 305.158 32.4139 305.004 31.4298C304.851 30.4538 305.073 29.7986 306.275 30.0369C307.191 30.2183 307.396 29.7617 307.349 28.9311C307.31 28.2433 307.317 27.553 307.324 26.8625V26.861C307.328 26.4402 307.333 26.0193 307.327 25.5988C307.323 25.3383 307.301 25.0347 307.167 24.8302C306.989 24.5584 302.512 24.6538 302.296 24.9298C302.139 25.1293 301.976 25.441 302.02 25.6616C302.375 27.4292 301.35 27.527 300.044 27.3825C299.769 27.352 299.49 27.3619 299.21 27.3718C298.932 27.3817 298.654 27.3915 298.38 27.3616C297.379 27.2523 296.777 27.479 296.994 28.6604C297.128 29.3846 296.921 29.7275 296.05 29.7423C295.112 29.7583 294.86 29.3956 295.006 28.5918C295.206 27.498 294.685 27.1971 293.721 27.3756C292.504 27.601 292.163 27.0486 292.322 25.9239C292.416 25.2592 292.479 24.5626 291.387 24.6953ZM212.333 6.37183C212.333 6.91186 212.34 7.43697 212.347 7.95136C212.363 9.12985 212.378 10.2521 212.306 11.3689C212.241 12.3912 212.754 12.3885 213.465 12.3848L213.498 12.3846L213.56 12.3844C214.255 12.3818 214.888 12.3795 214.663 11.3766C214.293 9.72771 215.221 9.65347 216.497 9.68205C219.662 9.75288 222.83 9.75257 225.994 9.67918C227.072 9.65417 227.533 9.93737 227.334 11.0343C227.139 12.1105 227.568 12.571 228.662 12.3724C229.741 12.1765 230.037 12.6088 230.027 13.7021C229.97 19.5891 229.972 25.4772 230.026 31.3642C230.036 32.4404 229.769 32.742 228.671 32.7348L228.54 32.734C224.667 32.7092 224.667 32.7092 224.667 28.7071C224.667 27.8049 224.664 26.9026 224.662 26.0003C224.655 23.6254 224.648 21.2505 224.688 18.8764C224.704 17.9436 224.453 17.5236 223.506 17.7086C222.338 17.9368 222.202 17.2594 222.339 16.3794C222.508 15.3004 222.108 14.9476 221.004 15.013C219.344 15.1114 217.672 15.0788 216.008 15.0213C215.212 14.9938 214.899 15.2241 214.989 16.0365C215.02 16.324 215.011 16.6157 215.002 16.9077V16.908C214.994 17.1731 214.985 17.4384 215.008 17.7008C215.134 19.1771 215.147 20.4665 212.999 20.0615C212.22 19.9146 212.276 20.451 212.324 20.9062C212.336 21.013 212.346 21.1153 212.346 21.2033C212.323 24.6468 212.3 28.0911 212.355 31.5338C212.37 32.472 212.111 32.722 211.168 32.7309L211.06 32.7319C209.197 32.7496 208.265 32.7585 207.799 32.297C207.333 31.8354 207.333 30.9032 207.333 29.0384V29.0374C207.333 26.8457 207.335 24.6539 207.336 22.4622C207.341 15.4893 207.346 8.51645 207.302 1.54391C207.294 0.305724 207.576 -0.0260434 208.832 0.00393292L209.02 0.00837085C212.332 0.0862622 212.333 0.0862975 212.333 3.53925V6.37183ZM99.674 14.1553C99.6703 14.6603 99.6666 15.1756 99.6666 15.7056C99.6666 16.4803 99.6642 17.2421 99.6619 17.9946V17.9961V17.9976V17.999V18.0005V18.002V18.0034V18.0049V18.0063V18.0077V18.0091V18.0106V18.012V18.013C99.6559 19.9513 99.6502 21.8278 99.6844 23.7035C99.699 24.5003 99.4714 24.8588 98.6696 24.7015C97.3602 24.4447 97.1742 25.1745 97.3364 26.201C97.4849 27.1415 97.1179 27.4391 96.1685 27.3932C94.5614 27.3156 92.9437 27.3011 91.3386 27.3965C90.2492 27.4613 89.9598 27.1305 89.973 26.0385C90.0055 23.3403 90.0041 20.6417 90.0027 17.9431C90.0014 15.5872 90.0002 13.2312 90.0216 10.8755C90.0301 9.93635 89.7797 9.64348 88.832 9.68364C87.0578 9.75883 85.2758 9.75871 83.5016 9.68367C82.5547 9.64362 82.3034 9.93521 82.3116 10.875C82.3568 16.0958 82.3566 21.3173 82.3117 26.5381C82.3036 27.4761 82.5499 27.8328 83.5007 27.7198L83.5238 27.717L83.6011 27.7073L83.6016 27.7073L83.6021 27.7072C84.1454 27.6387 84.7297 27.5651 84.6864 28.5378C84.6721 28.8598 84.6363 29.2079 84.5999 29.5616C84.4869 30.66 84.3684 31.8119 84.8713 32.4011C85.3935 33.013 86.373 32.8986 87.372 32.7819C87.8729 32.7234 88.3787 32.6643 88.8342 32.6959C88.8671 32.6982 88.9 32.7002 88.9327 32.7022C89.372 32.7292 89.7853 32.7547 89.6569 33.3698C89.2733 35.2066 90.4163 35.1305 91.6287 35.0498L91.6659 35.0473C92.3848 34.9995 93.1157 34.9786 93.83 35.0534C94.7708 35.152 95.1664 34.8209 95 33.8743C94.835 32.935 95.2183 32.6581 96.1641 32.683C97.351 32.7142 98.539 32.708 99.727 32.7018C101.039 32.6949 102.351 32.688 103.661 32.7316C104.747 32.7677 105.037 32.4657 105.027 31.3727C104.984 27.0399 104.99 22.7067 104.996 18.3736C104.998 16.8745 105 15.3755 105 13.8765V13.8737C105 11.681 105 10.5925 104.456 10.0726C103.92 9.56008 102.856 9.60008 100.742 9.67952L100.668 9.68231C99.875 9.71209 99.6189 9.90332 99.6489 10.7073C99.6909 11.8361 99.6827 12.9667 99.674 14.1548V14.1553ZM262.332 9.70518C262.517 9.70518 262.684 9.71062 262.84 9.71567C263.146 9.72564 263.406 9.73407 263.658 9.69601C264.733 9.53391 265.153 9.92651 265.019 11.0345C265.014 11.0789 265.008 11.1237 265.002 11.1685L265.001 11.1711C264.92 11.7908 264.837 12.4234 265.991 12.4211C267.11 12.4189 267.06 11.8435 267.003 11.2031C266.999 11.1532 266.994 11.1029 266.99 11.0525C266.913 10.0466 267.315 9.67959 268.335 9.68873C272.667 9.72757 276.999 9.72506 281.331 9.6874C282.133 9.68043 282.354 9.90821 282.35 10.7076C282.32 17.7058 282.32 24.7042 282.35 31.7023C282.354 32.501 282.136 32.7482 281.331 32.7231C279.5 32.666 277.664 32.6525 275.834 32.7269C274.887 32.7654 274.636 32.4744 274.645 31.5351C274.666 29.1764 274.665 26.8175 274.664 24.4586C274.662 21.7632 274.661 19.0677 274.693 16.3726C274.706 15.2822 274.419 14.9511 273.328 15.0136C271.668 15.1088 269.996 15.0806 268.332 15.0205C267.523 14.9913 267.244 15.2456 267.32 16.0451C267.353 16.3924 267.344 16.7436 267.335 17.0949V17.0957C267.327 17.4121 267.319 17.7287 267.341 18.0427L267.342 18.0549C267.431 19.2825 267.511 20.3958 265.659 20.0619C264.879 19.9214 264.939 20.4542 264.99 20.9065C265.002 21.0152 265.014 21.1193 265.013 21.2083C264.989 24.6517 264.965 28.096 265.022 31.5387C265.038 32.4846 264.764 32.7198 263.829 32.7302L263.732 32.7313C261.701 32.754 260.684 32.7654 260.176 32.2629C259.666 31.7595 259.666 30.7403 259.666 28.7001V28.699V12.2031C259.666 10.9812 259.666 10.3571 259.978 10.0382C260.304 9.70519 260.97 9.70519 262.332 9.70518ZM320.861 9.7109C319.832 9.70857 318.793 9.70622 317.742 9.70637C316.797 9.92296 316.896 10.48 316.986 10.9924C317.015 11.1564 317.044 11.3159 317.036 11.4582C317.001 12.1791 316.817 12.4225 316.084 12.3925L316.019 12.39L315.973 12.3883C315.352 12.3659 314.844 12.3476 314.999 11.4617C315.276 9.87328 314.421 9.55344 313.073 9.69272C312.358 9.76651 311.62 9.78038 310.91 9.68826C309.852 9.55099 309.633 9.95715 309.642 10.9678C309.679 15.3687 309.675 19.7701 309.67 24.1715C309.668 25.6579 309.666 27.1443 309.666 28.6307C309.666 32.7318 309.666 32.7318 313.63 32.7365L313.76 32.7366C314.815 32.738 315.039 32.4477 315.025 31.4411C314.982 28.4606 314.988 25.4795 314.994 22.4983C314.997 21.3135 314.999 20.1287 314.999 18.9439C314.999 18.8669 314.996 18.7876 314.994 18.708V18.7073C314.975 18.1158 314.956 17.5114 315.925 17.7146C317.391 18.022 317.466 17.1498 317.326 16.114C317.204 15.2201 317.571 14.9862 318.427 15.0206C320.036 15.0851 321.654 15.1237 323.257 15.0112C324.447 14.9276 324.869 15.3118 324.671 16.4668C324.528 17.3009 324.698 17.9089 325.758 17.7051C326.805 17.504 327.047 17.9488 327.025 18.9641C326.975 21.2862 326.984 23.6094 326.993 25.9327C326.996 26.8313 327 27.7299 327 28.6283V28.6302C327 30.7296 327 31.7773 327.523 32.2891C328.045 32.7989 329.086 32.777 331.165 32.7333L331.259 32.7313C332.146 32.7127 332.356 32.4636 332.351 31.6103C332.317 25.5562 332.314 19.5016 332.354 13.4475C332.36 12.5605 332.106 12.2144 331.243 12.3745C330.204 12.5671 329.832 12.144 329.993 11.1193C330.165 10.0245 329.643 9.67235 328.565 9.68727C326.017 9.72256 323.468 9.7168 320.861 9.7109ZM250.149 9.59582C252.218 9.69557 254.163 9.73897 256.106 9.68797C256.967 9.66537 257.35 9.78394 257.364 10.8153L257.366 10.941V10.9414C257.393 12.9735 257.407 13.9978 256.902 14.5141C256.389 15.0389 255.339 15.0389 253.222 15.0389H253.22C250 15.0389 250 15.0389 250 18.3215C250 19.4756 249.998 20.6297 249.996 21.7837C249.991 24.9623 249.986 28.1409 250.02 31.3191C250.03 32.3127 249.903 32.7506 248.716 32.7409L248.548 32.7396C244.667 32.7087 244.667 32.7087 244.667 28.7521C244.667 27.6465 244.665 26.541 244.662 25.4354C244.657 22.4305 244.651 19.4255 244.687 16.421C244.699 15.4201 244.563 14.9314 243.376 15.0027C243.09 15.0198 242.778 15.0617 242.459 15.1043C241.452 15.2392 240.383 15.3823 239.893 14.7794C239.515 14.3138 239.571 13.5204 239.629 12.6993C239.664 12.2048 239.7 11.7003 239.642 11.2512C239.461 9.84845 240.083 9.65435 241.295 9.6793C244.666 9.74872 244.667 9.69936 244.667 6.40854C244.667 6.16716 244.674 5.92474 244.682 5.68233C244.7 5.14376 244.718 4.60518 244.648 4.07798C244.475 2.75211 244.846 2.07548 246.298 2.37089C247.258 2.5663 247.466 2.02199 247.325 1.24412C247.122 0.121197 247.687 -0.00367384 248.629 0.0190778C251.072 0.0780918 253.518 0.0841007 255.96 0.0172954C256.979 -0.0105806 257.38 0.17514 257.367 1.33674L257.365 1.50469C257.327 5.00278 257.327 5.03839 253.7 5.01529C252.677 5.00878 252.121 5.18618 252.329 6.34037C252.512 7.35794 252.194 7.87058 251.032 7.72064C249.788 7.56005 249.924 8.23827 250.062 8.92334C250.109 9.15782 250.157 9.3931 250.149 9.59582ZM192.316 29.0541C192.241 29.4682 192.156 29.9462 193.025 30.0378C194.459 29.7781 194.89 30.3422 194.667 31.5534C194.49 32.518 194.929 32.7645 195.849 32.7253C197.022 32.6754 198.198 32.6859 199.374 32.6965C199.865 32.7009 200.356 32.7053 200.847 32.7053H200.85C203.037 32.7053 204.123 32.7053 204.642 32.1624C205.155 31.6259 205.112 30.5591 205.028 28.4381L205.024 28.356C204.992 27.5383 204.759 27.3313 203.981 27.3554C203.194 27.3798 202.407 27.3731 201.62 27.3664C200.685 27.3585 199.75 27.3506 198.817 27.3946C197.842 27.4407 197.626 27.0996 197.646 26.1846C197.688 24.2706 197.68 22.3555 197.672 20.4405C197.669 19.6895 197.666 18.9385 197.666 18.1876C197.666 16.6193 197.666 15.8321 198.06 15.4369C198.457 15.0386 199.253 15.0386 200.853 15.0386H200.857C203.041 15.0386 204.127 15.0386 204.645 14.496C205.158 13.9593 205.115 12.8917 205.029 10.7679L205.025 10.683C204.992 9.85615 204.743 9.66629 203.975 9.68926C203.198 9.71245 202.421 9.70576 201.644 9.69907C200.699 9.69094 199.754 9.68281 198.811 9.72839C197.826 9.77604 197.61 9.41903 197.647 8.51131C197.68 7.71554 197.671 6.91797 197.663 6.12047C197.654 5.25103 197.646 4.38168 197.69 3.51489C197.74 2.52655 197.371 2.35838 196.472 2.3494L196.387 2.34855C194.366 2.32826 193.353 2.31809 192.845 2.81971C192.333 3.32456 192.333 4.34783 192.333 6.40095V6.40168C192.333 9.69938 192.332 9.74565 188.969 9.68047C187.773 9.6573 187.251 9.82819 187.292 11.2409L187.299 11.4758C187.398 14.9872 187.4 15.0433 191.035 15.0048C192.196 14.9925 192.368 15.3938 192.355 16.4113C192.303 20.5204 192.318 24.6307 192.354 28.7402C192.355 28.8341 192.336 28.9418 192.316 29.0541ZM179.666 11.0841C179.535 10.053 179.769 9.68833 180.785 9.67505L180.906 9.67347C182.935 9.64678 183.958 9.63332 184.474 10.1383C185 10.6524 185 11.7039 185 13.826V13.8276C185 15.3021 184.998 16.7766 184.997 18.2512C184.993 22.6094 184.989 26.9676 185.02 31.3255C185.027 32.3309 184.882 32.7488 183.708 32.7395L183.546 32.7382C179.667 32.7081 179.666 32.7081 179.666 28.7439V11.0841ZM182.173 5.01236C183.044 4.99686 183.933 4.98104 184.866 4.90763C184.928 4.28355 184.938 3.68652 184.949 3.10523V3.10509V3.10495V3.10481V3.10467V3.10453V3.10439V3.10372V3.1036V3.10349V3.10337V3.10325V3.10313C184.959 2.54607 184.968 2.00347 185.023 1.46539C185.141 0.297809 184.769 -0.00892864 183.588 0.00614102L183.434 0.00808085C181.432 0.033316 180.432 0.0459253 179.958 0.551789C179.485 1.05699 179.537 2.05415 179.641 4.04716L179.645 4.12119C179.683 4.84267 179.853 5.08482 180.586 5.05362C181.112 5.03123 181.639 5.02185 182.173 5.01236ZM20.7082 22.373C19.8165 22.3966 19.9196 22.9207 19.9963 23.3103L19.9963 23.3103C20.0081 23.3704 20.0193 23.4274 20.0261 23.4788C20.1698 24.5625 19.7068 24.8852 18.73 24.703C17.5325 24.4797 17.1189 25.0032 17.3349 26.1374C17.5359 27.1924 17.0751 27.4283 16.0708 27.397C13.6339 27.3211 11.1922 27.3353 8.75429 27.3921C7.88845 27.4123 7.642 27.1704 7.64679 26.2926C7.68341 19.5849 7.68918 12.8767 7.64263 6.16903C7.63571 5.17136 7.98142 4.98596 8.87057 5.02047C10.5312 5.08493 12.1992 5.09951 13.8581 5.01613C14.8399 4.96679 15.1695 5.32523 14.9959 6.22759C14.7481 7.51523 15.316 7.88945 16.5204 7.72026C16.8395 7.67544 17.166 7.68801 17.493 7.70059C17.7788 7.7116 18.065 7.72262 18.3468 7.6953C19.4933 7.58418 20.2882 7.75539 20.0098 9.21463C19.8244 10.1866 20.527 10.1013 21.0798 10.0342L21.1665 10.0238C22.1133 9.91371 22.372 10.262 22.3556 11.2022C22.2984 14.4721 22.2673 17.7455 22.3671 21.0133C22.4053 22.2662 21.9424 22.5558 20.7082 22.373ZM38.0563 15.1556C37.9715 15.1591 37.8843 15.1627 37.7947 15.1671C37.3086 16.998 37.9754 17.5402 39.7204 17.4111C41.9194 17.2485 44.1425 17.3051 46.3494 17.4008C47.339 17.4438 47.3409 16.9682 47.3434 16.3324C47.3436 16.2884 47.3438 16.2437 47.3443 16.1984L47.3444 16.1915C47.3524 15.4716 47.3595 14.8362 46.3369 15.0374C44.9839 15.3035 44.4283 14.7985 44.6508 13.3907C44.804 12.4219 43.9569 12.6249 43.5379 12.7358C43.1143 12.8479 42.5773 12.7588 42.0561 12.6723C41.1424 12.5207 40.2777 12.3771 40.159 13.3403C39.945 15.077 39.2273 15.1068 38.0563 15.1556ZM127.323 21.8812V21.8814C127.313 22.1879 127.305 22.4465 127.342 22.6985C127.554 24.1384 127.276 25.0451 125.503 24.7212C124.475 24.5335 124.58 25.2484 124.661 25.7994C124.673 25.8816 124.684 25.9601 124.691 26.0314C124.801 27.118 124.435 27.4386 123.337 27.3995C120.896 27.3126 118.449 27.3412 116.006 27.3902C115.21 27.4062 114.972 27.1811 114.982 26.3742C115.025 22.931 115.024 19.4867 114.982 16.0435C114.973 15.246 115.194 15.0042 116 15.0208C118.443 15.0714 120.889 15.0967 123.33 15.0128C124.417 14.9754 124.817 15.2755 124.685 16.3735L124.675 16.4536C124.593 17.1132 124.49 17.9516 125.664 17.6985C127.323 17.341 127.478 18.2698 127.343 19.54C127.304 19.9083 127.313 20.2816 127.323 20.7046V20.7047V20.7047V20.7048C127.328 20.9126 127.333 21.1323 127.333 21.3693C127.333 21.5558 127.328 21.7245 127.323 21.8807V21.881V21.8812ZM345.008 28.6015C344.94 29.179 344.861 29.8593 346.001 29.7056C346.103 29.6985 346.209 29.6992 346.312 29.6999C346.717 29.7026 347.073 29.7049 346.975 29.2275C346.57 27.2531 347.711 27.3038 348.873 27.3555C349.017 27.3619 349.162 27.3683 349.304 27.3709C349.485 27.3742 349.666 27.3691 349.848 27.364C350.166 27.3551 350.485 27.3461 350.798 27.3826C351.69 27.4864 352.044 27.2374 352.025 26.2411C351.96 22.8628 351.966 19.4818 352.023 16.1032C352.038 15.1953 351.735 15.0036 350.898 15.0213C348.517 15.0719 346.131 15.1081 343.753 15.0095C342.589 14.9613 342.112 15.2759 342.332 16.4486C342.521 17.4515 342.147 17.909 341.098 17.7067C340.054 17.5054 339.954 18.0918 339.985 18.9352C340.04 20.4291 340.055 21.9292 339.98 23.4214C339.932 24.3793 340.109 24.9256 341.21 24.7083C342.209 24.5113 342.498 25.0335 342.327 25.9073C342.07 27.2246 342.692 27.5777 343.862 27.3716C344.839 27.1994 345.117 27.6532 345.012 28.5617L345.008 28.6015ZM69.667 28.0689C69.6524 28.2526 69.6621 28.4373 69.6714 28.6137C69.7043 29.2376 69.7316 29.7571 68.6564 29.7537C67.5404 29.7502 67.6011 29.1677 67.6638 28.565C67.6705 28.5007 67.6772 28.436 67.6825 28.3718C67.7492 27.5677 67.4694 27.242 66.6706 27.3695C66.5936 27.3818 66.5139 27.3783 66.4343 27.3748C66.4023 27.3734 66.3704 27.372 66.3386 27.3717C62.6663 27.3285 62.6663 27.3285 62.6663 23.7262C62.6663 23.3072 62.6698 22.888 62.6733 22.4688C62.6813 21.5024 62.6894 20.5361 62.6546 19.5712L62.6525 19.5124C62.6102 18.3545 62.573 17.3358 64.2947 17.6866C65.1916 17.8694 65.0707 17.1451 64.9922 16.6743L64.9918 16.6723C64.987 16.6435 64.9824 16.6157 64.9782 16.5892C64.7593 15.2134 65.3817 14.9314 66.6138 15.0146C68.103 15.1153 69.6094 15.1149 71.0983 15.0127C72.1599 14.9398 72.5188 15.3039 72.3314 16.3003C72.1095 17.4798 72.6016 17.9159 73.754 17.7075C74.4823 17.5758 74.7044 17.8959 74.6818 18.6213C74.6317 20.2265 74.6038 21.8377 74.6892 23.4399C74.7423 24.4376 74.5014 24.903 73.4364 24.7099C72.6164 24.5612 72.1507 24.849 72.3358 25.7606C72.6357 27.2381 71.9105 27.5706 70.6162 27.3891C70.5854 27.3847 70.553 27.3795 70.5195 27.3742C70.1521 27.3152 69.6585 27.2359 69.667 28.0689ZM291.713 15.0389C289.721 15.0405 289.637 15.1753 290.425 17.3637C291.453 17.3667 292.457 17.3667 293.447 17.3667C295.06 17.3667 296.635 17.3667 298.211 17.3794C298.281 17.38 298.35 17.3814 298.417 17.3828C299.176 17.3983 299.756 17.4102 299.725 16.1739C299.696 14.9724 299.139 14.9269 298.318 15.0489C297.214 15.2129 296.816 14.766 296.999 13.7029C297.135 12.914 296.814 12.6693 296.01 12.6769C295.237 12.6841 294.845 12.8676 295.004 13.6831C295.251 14.9446 294.607 15.1789 293.535 15.0517C293.121 15.0024 292.699 15.015 292.276 15.0276C292.088 15.0332 291.9 15.0388 291.713 15.0389Z"
                fill="white"
              />
            </svg>
          </div>
          <div ref={calloutOne} className={s.calloutOneWrapper}>
            <p className={s.calloutOne}>Can we fix this text?</p>
            <svg
              width="20"
              height="22"
              viewBox="0 0 20 22"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g filter="url(#filter0_d_307_283)">
                <path
                  d="M3.15252 17.3934L9.92321 2.60645L17.0011 17.3934L10.0512 14.9289L3.15252 17.3934Z"
                  fill="black"
                />
                <path
                  d="M3.15252 17.3934L9.92321 2.60645L17.0011 17.3934L10.0512 14.9289L3.15252 17.3934Z"
                  stroke="white"
                />
              </g>
              <defs>
                <filter
                  id="filter0_d_307_283"
                  x="0.200867"
                  y="0.427734"
                  width="19.7701"
                  height="20.8379"
                  filterUnits="userSpaceOnUse"
                  colorInterpolationFilters="sRGB"
                >
                  <feFlood floodOpacity="0" result="BackgroundImageFix" />
                  <feColorMatrix
                    in="SourceAlpha"
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                    result="hardAlpha"
                  />
                  <feOffset dy="1" />
                  <feGaussianBlur stdDeviation="1" />
                  <feComposite in2="hardAlpha" operator="out" />
                  <feColorMatrix
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
                  />
                  <feBlend
                    mode="normal"
                    in2="BackgroundImageFix"
                    result="effect1_dropShadow_307_283"
                  />
                  <feBlend
                    mode="normal"
                    in="SourceGraphic"
                    in2="effect1_dropShadow_307_283"
                    result="shape"
                  />
                </filter>
              </defs>
            </svg>
          </div>
          <div ref={calloutTwo} className={s.calloutTwoWrapper}>
            <p className={s.calloutTwo}>Sure!</p>
            <svg
              width="20"
              height="22"
              viewBox="0 0 20 22"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g filter="url(#filter0_d_307_283)">
                <path
                  d="M3.15252 17.3934L9.92321 2.60645L17.0011 17.3934L10.0512 14.9289L3.15252 17.3934Z"
                  fill="black"
                />
                <path
                  d="M3.15252 17.3934L9.92321 2.60645L17.0011 17.3934L10.0512 14.9289L3.15252 17.3934Z"
                  stroke="white"
                />
              </g>
              <defs>
                <filter
                  id="filter0_d_307_283"
                  x="0.200867"
                  y="0.427734"
                  width="19.7701"
                  height="20.8379"
                  filterUnits="userSpaceOnUse"
                  colorInterpolationFilters="sRGB"
                >
                  <feFlood floodOpacity="0" result="BackgroundImageFix" />
                  <feColorMatrix
                    in="SourceAlpha"
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                    result="hardAlpha"
                  />
                  <feOffset dy="1" />
                  <feGaussianBlur stdDeviation="1" />
                  <feComposite in2="hardAlpha" operator="out" />
                  <feColorMatrix
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
                  />
                  <feBlend
                    mode="normal"
                    in2="BackgroundImageFix"
                    result="effect1_dropShadow_307_283"
                  />
                  <feBlend
                    mode="normal"
                    in="SourceGraphic"
                    in2="effect1_dropShadow_307_283"
                    result="shape"
                  />
                </filter>
              </defs>
            </svg>
            <span className={s.calloutClick} />
            <span className={s.calloutClick} />
          </div>
        </div>

        <div className={s.features}>
          {data.map((item, index) => (
            <div className={s.feature} key={item.id}>
              <Card {...item} invertedPattern={index % 2 === 0} />
            </div>
          ))}
        </div>
      </div>
    </Section>
  )
}

const Card = ({
  icon,
  title,
  subtitle,
  invertedPattern
}: DataType & { invertedPattern: boolean }) => {
  const gridRef = useRef<HTMLDivElement>(null)

  const tileStates = useMemo(() => ['off', 'medium', 'high'], [])
  const gridRows = 3
  const gridCols = 9
  const tileCount = gridRows * gridCols

  useEffect(() => {
    const interval = setInterval(() => {
      Array.from({ length: tileCount }).forEach((_, index) => {
        if (index % 2 === (invertedPattern ? 0 : 1)) {
          const tile: HTMLElement | null | undefined =
            gridRef.current?.querySelector(`[data-index="${index}"]`)

          if (!tile) return

          // Pick a random next state
          const nextState =
            tileStates[Math.floor(Math.random() * tileStates.length)]
          const currentState = tile.dataset.state

          const pulse =
            Math.random() > 0.2 &&
            // Make sure we only pulsate going from "off" → "medium" → "high"
            ((currentState === 'off' && nextState === 'high') ||
              (currentState === 'off' && nextState === 'medium') ||
              (currentState === 'medium' && nextState === 'high'))

          // After a pulse, don't transition from "high" → "medium"
          if (currentState === 'high' && nextState === 'medium' && pulse) {
            tile.dataset.state = 'off'
          } else {
            tile.dataset.state = nextState
          }
        }
      })
    }, 1200)

    return () => {
      clearInterval(interval)
    }
  }, [tileCount, tileStates, invertedPattern])

  return (
    <Lantern.Root className={s.card}>
      <Lantern.MaskBorder />

      <Lantern.ContentWrapper className={s.content}>
        <div
          className={s.grid}
          style={{
            // @ts-ignore
            ['--rows']: gridRows,
            ['--cols']: gridCols
          }}
          ref={gridRef}
        >
          {Array.from({ length: tileCount }).map((_, index) => (
            <div
              className={s.tile}
              key={index}
              data-index={index}
              data-state="off"
            />
          ))}
        </div>

        <div className={s.iconWrapper}>{icon}</div>
        <div>
          <p className={s.title}>{title}</p>
          <p className={s.subtitle}>{subtitle}</p>
        </div>
      </Lantern.ContentWrapper>
    </Lantern.Root>
  )
}

type DataType = {
  id: number
  title: string
  subtitle: string
  icon: ReactNode
}

const data: DataType[] = [
  {
    id: 0,
    title: 'Time-Travel.',
    subtitle: 'Warp to the comment’s execution context.',
    icon: (
      <svg
        width="20"
        height="20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M10 5v5h3.75m3.75 0a7.49996 7.49996 0 0 1-2.1967 5.3033 7.49996 7.49996 0 0 1-10.6066 0 7.49907 7.49907 0 0 1-1.6258-2.4332A7.49977 7.49977 0 0 1 2.5 10c0-1.98912.79018-3.89678 2.1967-5.3033S8.01088 2.5 10 2.5c1.9891 0 3.8968.79018 5.3033 2.1967C16.7098 6.10322 17.5 8.01088 17.5 10Z"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    )
  },
  {
    id: 1,
    title: 'Contextual comments.',
    subtitle: 'Jump to  the video frame or network request.',
    icon: (
      <svg
        width="20"
        height="20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.25 6.875h7.5m-7.5 2.5H10m-8.125 1.2583c0 1.3334.93583 2.495 2.25583 2.6892.94084.1383 1.89167.2442 2.8525.3158.29167.0217.55834.175.72084.4175L10 17.5l2.2958-3.4442a.9507.9507 0 0 1 .3122-.2919.95051.95051 0 0 1 .4087-.1256 40.1444 40.1444 0 0 0 2.8525-.3158c1.32-.1942 2.2558-1.355 2.2558-2.69v-5.015c0-1.335-.9358-2.49583-2.2558-2.69A40.32865 40.32865 0 0 0 10 2.5c-1.99333 0-3.95333.14584-5.86917.4275-1.32.19417-2.25583 1.35584-2.25583 2.69v5.0158Z"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    )
  },
  {
    id: 2,
    title: 'Shared print statement.',
    subtitle: 'Get on the same page with synced Console logs.',
    icon: (
      <svg
        width="20"
        height="20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M11.875 8.125 13.75 10l-1.875 1.875m-3.75 0L6.25 10l1.875-1.875M5 16.875h10c.4973 0 .9742-.1975 1.3258-.5492.3517-.3516.5492-.8285.5492-1.3258V5c0-.49728-.1975-.97419-.5492-1.32583A1.87485 1.87485 0 0 0 15 3.125H5a1.87503 1.87503 0 0 0-1.32583.54917A1.87503 1.87503 0 0 0 3.125 5v10c0 .4973.19754.9742.54917 1.3258A1.87476 1.87476 0 0 0 5 16.875Z"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    )
  },
  {
    id: 3,
    title: 'At Mention.',
    subtitle: 'Pull in team members who have relevant context.',
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M16.875 7.0925C17.6117 7.32917 18.125 8.0325 18.125 8.84V12.4117C18.125 13.3583 17.4192 14.1617 16.475 14.2392C16.1917 14.2617 15.9083 14.2825 15.625 14.2992V16.875L13.125 14.375C11.9967 14.375 10.88 14.3292 9.775 14.2392C9.53444 14.2197 9.30044 14.1511 9.0875 14.0375M16.875 7.0925C16.7462 7.05106 16.6131 7.02449 16.4783 7.01333C14.2466 6.82807 12.0034 6.82807 9.77167 7.01333C8.82917 7.09167 8.125 7.89417 8.125 8.84V12.4117C8.125 13.1092 8.50833 13.7283 9.0875 14.0375M16.875 7.0925V5.53083C16.875 4.18 15.915 3.00917 14.575 2.835C12.8507 2.61149 11.1137 2.49959 9.375 2.5C7.6125 2.5 5.87667 2.61417 4.175 2.835C2.835 3.00917 1.875 4.18 1.875 5.53083V10.7192C1.875 12.07 2.835 13.2408 4.175 13.415C4.65583 13.4775 5.13917 13.5317 5.625 13.5767V17.5L9.0875 14.0375"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    )
  },
  {
    id: 4,
    title: 'Loom embeds.',
    subtitle: 'Talk through what you’re seeing with video comments.',
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M13.125 8.75L17.0583 4.81667C17.1457 4.72937 17.2571 4.66993 17.3782 4.64586C17.4994 4.62179 17.625 4.63417 17.7391 4.68143C17.8532 4.72869 17.9508 4.80871 18.0195 4.91139C18.0882 5.01407 18.1249 5.1348 18.125 5.25833V14.7417C18.1249 14.8652 18.0882 14.9859 18.0195 15.0886C17.9508 15.1913 17.8532 15.2713 17.7391 15.3186C17.625 15.3658 17.4994 15.3782 17.3782 15.3541C17.2571 15.3301 17.1457 15.2706 17.0583 15.1833L13.125 11.25M3.75 15.625H11.25C11.7473 15.625 12.2242 15.4275 12.5758 15.0758C12.9275 14.7242 13.125 14.2473 13.125 13.75V6.25C13.125 5.75272 12.9275 5.27581 12.5758 4.92417C12.2242 4.57254 11.7473 4.375 11.25 4.375H3.75C3.25272 4.375 2.77581 4.57254 2.42417 4.92417C2.07254 5.27581 1.875 5.75272 1.875 6.25V13.75C1.875 14.2473 2.07254 14.7242 2.42417 15.0758C2.77581 15.4275 3.25272 15.625 3.75 15.625Z"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
        />
      </svg>
    )
  },
  {
    id: 5,
    title: 'Issue tracking.',
    subtitle: 'Track bugs with formatted and linked GitHub issues.',
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M17.5 17.5002L13.1691 13.1693M13.1691 13.1693C14.3413 11.9972 14.9998 10.4074 14.9998 8.74975C14.9998 7.09208 14.3413 5.50231 13.1691 4.33016C11.997 3.15802 10.4072 2.49951 8.74956 2.49951C7.0919 2.49951 5.50213 3.15802 4.32998 4.33016C3.15783 5.50231 2.49933 7.09208 2.49933 8.74975C2.49933 10.4074 3.15783 11.9972 4.32998 13.1693C5.50213 14.3415 7.0919 15 8.74956 15C10.4072 15 11.997 14.3415 13.1691 13.1693Z"
          stroke="currentColor"
          strokeWidth="1.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    )
  }
]
